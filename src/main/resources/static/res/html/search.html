<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>搜索页面</title>
    <script src="../js/vue.js"></script>
    <script src="../js/axios0.18.js"></script>
    <script src="../js/pub.js"></script>
    <link type="text/css" rel="stylesheet" href="../css/search.css">
</head>
<body>
<div id="app">
    <h1>这里是搜索界面</h1>
    <div class="input-container">
        <div>
            <input class="input-item" placeholder="search" 
            type="text" id="username" required>
        </div>
            <input class="btn" type="submit" value="查询">
    </div>
    
    <table class="centered-table" border="1">
    <tbody>
        <tr v-for="item in infoList">
            <td>
                <div class="child-container">
                    <img class="image" src={{item.picUrl}} alt="A science device?">
                </div>
            </td>
            <td>
                <div class="text-container">
                    <h1>{{item.name}}</h1>
                    <div style="height: 200px;background-color: aqua;">
                    <p>id:{{item.id}}</p>
                        <p>是否借用中？{{item.isLend}}</p>
                        <p>是否报废？{{item.isScrap}}</p>
                        <p>描述：{{item.description}}</p>
                    </div>
                    <div>
                        <input class="btn" type="submit" value="查看详情">
                    </div>
    
                </div>
            </td>
        </tr>
    </tbody>
    </table>
    <div class="jump-btn">
        <div>
            <button @click="prePage()">上一页</button>
            <p>{{pageCurrent}}</p>
            <button @click="nextPage()">下一页</button>
        </div>
    </div>
    
    </div>
</div>
</body>
<script>
    const aaa=[];
    new Vue({
        el:"#app",
        data:{
            pageCurrent:1,
            pageNum:10,
            infoList:[],
            userId:1
        },
        methods:{
            prePage: function(){
                let _this = this
                if(_this.pageCurrent>1){
                _this.pageCurrent--
                    _this.sendMassage()
                }
            },
            nextPage: function(){
                let _this = this
                if(_this.pageCurrent<_this.pageNum){
                _this.pageCurrent++
                    _this.sendMassage()
                }
            },
            sendMassage(){
                let _this = this;
                let data = {user_id: _this.userId, pageId: _this.pageCurrent};
                axios({
                    method: "post",
                    url: "/equipment/getEquipmetByUserId",
                    data: convertToQueryString(data)
                }).then(function (resp) {
                    console.log(resp.data);
                    if (resp.data.code == 200) {
                        _this.infoList=resp.data.data.rows
                        _this.pageNum=resp.data.data.total
                    } else {
                        alert(resp.data.msg);
                    }
                }).catch(function (error) {
                    console.log(error);
                });
            }
        },
        created(){
            let user_id = sessionStorage.getItem("user_id");
            this.userId=user_id
        },
        mounted: function (){
            this.sendMassage()
        }
    })
</script>
</html>